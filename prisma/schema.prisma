// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl", "linux-arm64-openssl-1.1.x", "linux-arm64-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  USER
}

model User {
  @@map("users")
  user_id      String   @id @default(uuid())
  firstname    String
  lastname     String
  mail         String   @unique
  password     String
  role         Role     @default(USER)  
  refreshToken String?
  created_at   DateTime
  updated_at   DateTime
  partners     Partner[]
  times        Time[]
  jobOffers    Job_offer[]
  structures   Structure[]
  statistics   Statistic[]
  news         News[]
  values       Value[]
  jobs         Job[]
  steps        Step[]
  files        File[]
}

model Partner {
  @@map("partners")
  parteners_id Int    @id @default(autoincrement())
  name         String
  image_url    String
  created_at   DateTime
  updated_at   DateTime
  user_id      String
  user         User   @relation(fields: [user_id], references: [user_id])
}

model Time {
  @@map("times")
  time_id           Int    @id @default(autoincrement())
  year              Int
  event_description String
  created_at        DateTime
  updated_at        DateTime
  user_id           String
  user              User   @relation(fields: [user_id], references: [user_id])
}

model Job_offer {
  @@map("job_offers")
  job_offer_id Int    @id @default(autoincrement())
  name         String
  job_type     String
  city         String?
  image_url    String?
  link         String?
  description  String
  created_at   DateTime
  updated_at   DateTime
  user_id      String
  user         User   @relation(fields: [user_id], references: [user_id])
}

model Structure {
  @@map("structures")
  structure_id  Int     @id @default(autoincrement())
  name          String
  image_url     String?
  description   String
  address       String?
  phone_number  String?
  missions      String?
  link          String?
  schedule      String?
  created_at    DateTime
  updated_at    DateTime
  user_id       String
  user          User    @relation(fields: [user_id], references: [user_id])
}

model Statistic {
  @@map("statistics")
  statistic_id Int    @id @default(autoincrement())
  label        String
  value        Int
  year         Int
  created_at   DateTime
  updated_at   DateTime
  user_id      String
  type_id      Int
  user         User   @relation(fields: [user_id], references: [user_id])
  type         Type   @relation(fields: [type_id], references: [type_id])
}

model News {
  @@map("news")
  news_id     Int     @id @default(autoincrement())
  name        String
  image_url   String?
  link        String?
  description String
  created_at  DateTime
  updated_at  DateTime
  user_id     String
  user        User    @relation(fields: [user_id], references: [user_id])
}

model Value {
  @@map("values")
  value_id    Int     @id @default(autoincrement())
  name        String
  image_url   String?
  created_at  DateTime
  updated_at  DateTime
  user_id     String
  user        User    @relation(fields: [user_id], references: [user_id])
}

model Position {
  @@map("positions")
  position_id Int     @id @default(autoincrement())
  name        String
  created_at  DateTime
  updated_at  DateTime
  jobs        Job[]
}

model Job {
  @@map("jobs")
  job_id      Int     @id @default(autoincrement())
  function    String
  created_at  DateTime
  updated_at  DateTime
  position_id Int
  user_id     String
  position    Position @relation(fields: [position_id], references: [position_id])
  user        User     @relation(fields: [user_id], references: [user_id])
}

model Step {
  @@map("steps")
  step_id     Int     @id @default(autoincrement())
  name        String
  image_url   String?
  description String
  created_at  DateTime
  updated_at  DateTime
  user_id     String
  path_id     Int
  user        User    @relation(fields: [user_id], references: [user_id])
  path        Path    @relation(fields: [path_id], references: [path_id])
}

model Path {
  @@map("paths")
  path_id    Int     @id @default(autoincrement())
  name       String  @unique
  created_at DateTime
  updated_at DateTime
  steps      Step[]
}

model File {
  @@map("files")
  file_id    Int     @id @default(autoincrement())
  name       String
  file       Bytes
  created_at DateTime
  updated_at DateTime
  user_id    String
  user       User    @relation(fields: [user_id], references: [user_id])
}

model Type {
  @@map("types")
  type_id    Int     @id @default(autoincrement())
  name       String
  created_at DateTime
  updated_at DateTime
  statistics Statistic[]
}